# 流向整理需求文档

## 一、定义工作目录、输出目录

流向整理的工作目录为：C:\Users\DingBin\Downloads

流向整理的输出目录为：C:\Users\DingBin\Desktop

## 二、创建汇总的电子表格

在输出目录创建后缀为.xlsx的电子表格，名称为：湖北区域每日纯销统计+时间，时间为文件的创建时间的前一天并且格式为"XXXX-XX-XX"。文件创建好后打开创建的电子表格，且把激活的工作表的A1单元格值设置为"日期"，B1单元格值设置为"品种"，C1单元格值设置为"规格"，D1单元格值设置为"批号"，E1单元格值设置为"单位名称"，F1单元格值设置为"数量"

## 三、循环打开工作目录下的后缀为.xls或.xlsx的电子表格，根据下述情况分别适用不同的整理规格

1. 如果打开的电子表格：A1单元格值="销售日期"、B1单元格值="单位名称"、C1单元格值="商品名称"、D1单元格值="商品规格"、F1单元格值="销售数量"、H1单元格值="销售批号"，那么整理规则如下：1、替换单元格内的全部空格；2、对应列进行移动：把"销售日期"列移动到第一列、"商品名称"列移动到第二列、"商品规格"列移动到第三列、"销售批号"列移动到第四列、"单位名称"列移动到第五列、"销售数量"列移动到第六列；3、第四列和第六列的格式全部转换为常规格式；4、把第二行到最后一行与第一列至第六列的内容已追加累计的形式拷贝进输出目录前缀为湖北区域每日纯销统计的电子表格内并保存；5、关闭当前已打开的电子表格
2. 如果打开的电子表格：A1单元格值="日期"、E1单元格值="销往单位"、I1单元格值="药品名称"、K1单元格值="规格"、L1单元格值="数量"、N1单元格值="批号"，那么整理规则如下：1、替换单元格内的全部空格；2、对应列进行移动：把"日期"列移动到第一列、"药品名称"列移动到第二列、"规格"列移动到第三列、"批号"列移动到第四列、"销往单位"列移动到第五列、"数量"列移动到第六列；3、第四列和第六列的格式全部转换为常规格式；4、把第二行到最后一行与第一列至第六列的内容已追加累计的形式拷贝进输出目录前缀为湖北区域每日纯销统计的电子表格内并保存；5、关闭当前已打开的电子表格
3. 如果打开的电子表格：A1单元格值="销售日期"、D1单元格值="销售商"、F1单元格值="商品名称"、G1单元格值="商品规格"、J1单元格值="数量"、M1单元格值="批号"，那么整理规则如下：1、替换单元格内的全部空格；2、对应列进行移动：把"销售日期"列移动到第一列、"商品名称"列移动到第二列、"商品规格"列移动到第三列、"批号"列移动到第四列、"销售商"列移动到第五列、"数量"列移动到第六列；3、第四列和第六列的格式全部转换为常规格式；4、把第二行到最后一行与第一列至第六列的内容已追加累计的形式拷贝进输出目录前缀为湖北区域每日纯销统计的电子表格内并保存；5、关闭当前已打开的电子表格
4. 如果打开的电子表格：A1单元格值="销售日期"、D1单元格值="销售商"、F1单元格值="商品名称"、G1单元格值="商品规格"、J1单元格值="批号"、K1单元格值="数量"，那么整理规则如下：1、替换单元格内的全部空格；2、对应列进行移动：把"销售日期"列移动到第一列、"商品名称"列移动到第二列、"商品规格"列移动到第三列、"批号"列移动到第四列、"销售商"列移动到第五列、"数量"列移动到第六列；3、第四列和第六列的格式全部转换为常规格式；4、把第二行到最后一行与第一列至第六列的内容已追加累计的形式拷贝进输出目录前缀为湖北区域每日纯销统计的电子表格内并保存；5、关闭当前已打开的电子表格
5. 如果打开的电子表格：C1单元格值="销售时间"、E1单元格值="客户名称"、J1单元格值="通用名"、N1单元格值="规格"、P1单元格值="供应商批次"、R1单元格值="销售数量"，那么整理规则如下：1、把C列从第二行起至最后一行的单元格整理为短日期，例如单元格值为20250631，需要替换为2025/06/31；2、对应列进行移动：把"销售时间"列移动到第一列、"通用名"列移动到第二列、"规格"列移动到第三列、"供应商批次"列移动到第四列、"客户名称"列移动到第五列、"销售数量"列移动到第六列；3、第四列和第六列的格式全部转换为常规格式；4、把第二行到最后一行与第一列至第六列的内容已追加累计的形式拷贝进输出目录前缀为湖北区域每日纯销统计的电子表格内并保存；5、关闭当前已打开的电子表格
6. 如果打开的电子表格：C1单元格值="发票日期"、E1单元格值="客户"、I1单元格值="商品名称"、J1单元格值="商品规格"、L1单元格值="开票数量"、P1单元格值="批号"，那么整理规则如下：1、替换单元格内的全部空格；2、对应列进行移动：把"发票日期"列移动到第一列、"商品名称"列移动到第二列、"商品规格"列移动到第三列、"批号"列移动到第四列、"客户"列移动到第五列、"开票数量"列移动到第六列；3、第四列和第六列的格式全部转换为常规格式；4、把第二行到最后一行与第一列至第六列的内容已追加累计的形式拷贝进输出目录前缀为湖北区域每日纯销统计的电子表格内并保存；5、关闭当前已打开的电子表格
7. 如果打开的电子表格：C1单元格值="出库日期"、L1单元格值="客户名称"、F1单元格值="商品名称"、G1单元格值="品种规格"、I1单元格值="数量"、H1单元格值="批号"，那么整理规则如下：1、替换单元格内的全部空格；2、对应列进行移动：把"出库日期"列移动到第一列、"商品名称"列移动到第二列、"品种规格"列移动到第三列、"批号"列移动到第四列、"客户名称"列移动到第五列、"数量"列移动到第六列；3、第四列和第六列的格式全部转换为常规格式；4、把第二行到最后一行与第一列至第六列的内容已追加累计的形式拷贝进输出目录前缀为湖北区域每日纯销统计的电子表格内并保存；5、关闭当前已打开的电子表格
8. 如果打开的电子表格：B1单元格值="制单时间"、E1单元格值="客户名称"、G1单元格值="品名"、H1单元格值="品规"、L1单元格值="订单数量"、O1单元格值="批号"，那么整理规则如下：1、替换单元格内的全部空格；2、对应列进行移动：把"制单时间"列移动到第一列、"品名"列移动到第二列、"品规"列移动到第三列、"批号"列移动到第四列、"客户名称"列移动到第五列、"订单数量"列移动到第六列；3、第四列和第六列的格式全部转换为常规格式；4、把第二行到最后一行与第一列至第六列的内容已追加累计的形式拷贝进输出目录前缀为湖北区域每日纯销统计的电子表格内并保存；5、关闭当前已打开的电子表格

## 四、汇总流向

关闭工作目录、输出目录所有已经打开的电子表格，并打开输出目录